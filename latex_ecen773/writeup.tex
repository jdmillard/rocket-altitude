\documentclass{article}

% preamble, set properties here
\usepackage{amsmath}  % for custom math
\usepackage{graphicx} % for figures
\usepackage{parskip}  % better loooking paragraphs
\usepackage{hyperref} % for internet links

\title{Rocket Altitude Trajectory Control}
\date{\today}
\author{Jeffrey Millard}

\begin{document}

%\pagenumbering{gobble}
\maketitle
%\newpage
%\pagenumbering{arabic}


\section{Introduction}
  I was approached by a member of the undergraduate AIAA club here at BYU who will be participating in a competition that involves sending a rocket to arrive precisely at 10,000 feet. With fins, the current rocket design is quite stable and we expect the rocket to climb perfectly vertical. Since the rules allow anyone to contribute, I've developed a simulation environment that is available publicly on GitHub at this \href{http://www.texample.net/tikz/resources/}{link}. The simulation simulates the rocket trajectory, control, estimation, and provides structure for Monte Carlo analysis.

  While many aspects of the simulation apply to linear system theory, my final project for ECEN 773 concerns itself with the overall approach to altitude trajectory control and more specifically, the Kalman Filter design and results. The KF estimates numerous states including the drag coefficient. This allows for accurate reference trajectory updates online, which yeilds increased robustness in the face of uncertain drag parameters.

\section{The Rocket}
  The problem is framed as follows. The simulation (including estimation and control) takes place immediately following the solid propellant burn. So our system can then be thought of as having an initial altitude ($h_0$) and velocity ($\dot{h}_0$). Since the rocket is traveling vertically without wind, $\dot{h}$ is considered the same as the airspeed. The equations of motion describing the system are
  \begin{equation}
    \ddot{h} = -g -D
  \end{equation}
  where $g$ is gravity and
  \begin{equation}
    D = \frac{1}{2} \rho \dot{h}^2 \bar{CD}
  \end{equation}
  $\bar{CD}$ is simply the convention chosen to represent a given drag coefficient already multiplied by a reference area so that it doesn't need to be chosen for the current rocket. This means that $\bar{CD}$ is not unitless, but the math is equivalent so long as we are consistent. This overall drag parameter can be represented as the base drag parameter plus the increase due to the air brake angle, $\theta$, as shown here
  \begin{equation}
    \bar{CD} = \bar{CD}_0 + \frac{\delta\bar{CD}}{\delta\theta} \theta
  \end{equation}
  where $\frac{\delta\bar{CD}}{\delta\theta}$ is considered a constant parameter. Since $\rho$ depends on our states, we can express it using $h$ and other constants
  \begin{equation}
    \rho = \rho_0 \left(   \frac{T_0 - \alpha\left( h-h_0 \right)}{T_0}   \right)^{n-1}
  \end{equation}
  where $\rho_0$, $T_0$, $\alpha$, and $n$ are the initial air density, initial air temperature, atmospheric temperature change, and gas constant, respectively.

  This results in the final equation
  \begin{equation}
    \ddot{h} = -g -\frac{1}{2} \left[\rho_0 \left(   \frac{T_0 - \alpha\left( h-h_0 \right)}{T_0}   \right)^{n-1}\right] \dot{h}^2 \left(\bar{CD}_0 + \frac{\delta\bar{CD}}{\delta\theta} \theta \right)
  \end{equation}

  The airbrake dynamics are governed by
  \begin{equation}
    \ddot{\theta} = \frac{\tau}{J} - \frac{\ell}{2}D_\theta \sin \theta
  \end{equation}
  where $\tau$ is the motor torque (input), $J$ is the angular inertia, $\ell$ is the airbrake surface length, and $D_\theta \sin \theta$ is simply the added drag due to airbrake deployment tending to push the brake back to $\theta=0$. This assumes that the center of pressure for the added airbrake drag is applied to the center of the surface, hence $\frac{\ell}{2}$ used as the moment arm for resistance torque. It is also worth noting that
  \begin{equation}
    D_\theta = \frac{1}{2} \rho \dot{h}^2 \left(\frac{\delta\bar{CD}}{\delta\theta} \theta \right)
  \end{equation}
  Using the same state-dependent expression for $\rho$, the full equation for airbrake dynamics is
  \begin{equation}
    \ddot{\theta} = \frac{\tau}{J} - \frac{\ell}{4} \left[ \rho_0 \left(   \frac{T_0 - \alpha\left( h-h_0 \right)}{T_0}   \right)^{n-1} \right] \dot{h}^2 \left(\frac{\delta\bar{CD}}{\delta\theta} \theta \right) \sin \theta
  \end{equation}

  This lays the groundwork for simulation and control. In the following sections, I discuss the control and estimation approaches used.

\section{The Trajectory Approach}
  Consider a dragless object in a gravity field. Regardless of whether or not the object is falling or climbing, the map of $\dot{h}$ vs $h$ is well-defined based on gravity. Such is not the case for an object with drag. The falling and climbing trajectories of $\dot{h}$ vs $h$ will be different. The approach used here is to generate a reference trajectory of the climbing rocket using a pessimistic drag such that it reaches the desired altitude with zero remaining velocity. Since the integral cannot be easily solved in closed form, an interative numerical approach is used to find the necessary starting velocity $h_0$ as well as the entire subsequent trajectory of $\dot{h}$ vs $h$. The idea is to control the velocity, $\dot{h}$, such that the rocket's motion converges on this trajectory without any overshoot (since we have no method of adding additional needed energy to the system). This can be done by using the reference trajectory as a look-up-table to find the desired $\dot{h}$ for any current $h$.

  The initial control approach was to use PID with successive loop closure and truth states in order to prove the concept of trajectory control. This could be improved upon using feedback linearization with the $\theta$ dynamics.

  The main problem to be addressed by this project is the observability and estimation of the base drag coefficient. In order to grasp the motivation, consider the case where 



  First section here

  Some notes:

  we have a baseline performance - successive loop closure

  now build the estimator


\end{document}
